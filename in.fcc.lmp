# ---------- HCP Co–Fe–Ni (non-conventional orientation + energy extraction) ----------
shell mkdir -p ${OUTDIR}

units          metal
atom_style     atomic
boundary       p p p

# --- Non-conventional orientation logging (for post-analysis clarity only) ---
variable orient_xx equal "1"
variable orient_xy equal "1"
variable orient_xz equal "0"
variable orient_yx equal "-1"
variable orient_yy equal "1"
variable orient_yz equal "0"
variable orient_zx equal "0"
variable orient_zy equal "0"
variable orient_zz equal "1"



read_data      ${DATA}

pair_style     eam/alloy
pair_coeff     * * ../potentials/FeNiCrCoAl-heaweight.setfl Co Fe Ni

neighbor       2.0 bin
neigh_modify   every 1 delay 0 check yes
timestep       0.002

thermo         500
thermo_style   custom step temp pe etotal press lx ly lz
thermo_modify  flush yes

# Minimization
min_style      cg
minimize       1e-12 1e-12 50000 100000

# NPT Equilibration
velocity       all create ${TEMP} 12345 mom yes rot yes dist gaussian
fix            1 all npt temp ${TEMP} ${TEMP} 0.1 iso 0.0 0.0 8.0
run            150000
unfix          1

# NVT Production
fix            2 all nvt temp ${TEMP} ${TEMP} 0.2
run            200000
unfix          2

# Energy + Structural Extraction
variable       N equal count(all)
variable       PE equal pe
variable       PE_PERATOM equal ${PE}/${N}
variable       Lx equal lx
variable       Ly equal ly
variable       Lz equal lz
variable       a1 equal v_Lx/8
variable       a2 equal v_Ly/8
variable       a3 equal v_Lz/8

print "-------------------------------------------"
print "FINAL_STRUCT = ${STRUCT}"
print "FINAL_TEMP = ${TEMP} K"
print "FINAL_PE_PERATOM = ${PE_PERATOM} eV"
print "Lattice vector a1 = ${a1} Å"
print "Lattice vector a2 = ${a2} Å"
print "Lattice vector a3 = ${a3} Å"
print "Orientation: x=[${orient_xx} ${orient_xy} ${orient_xz}], y=[${orient_yx} ${orient_yy} ${orient_yz}], z=[${orient_zx} ${orient_zy} ${orient_zz}]"
print "-------------------------------------------"

write_data ${OUTDIR}/final_${STRUCT}_${TEMP}K.data
print "END_OF_RUN"
